### Intro: 开篇先聊五毛钱天
**大爱无疆之感天泣地：为微软爸爸正名！就是今天了！**   
IoT实时数据可视化方案系列写（憋）到今天，终于来到了Power BI和Azure的领域。 聊起这两个赫赫有名的儿子，不得不提一提它们多金帅气的爸爸： Microsoft。 
虽然微软爸爸一直以十分体面精英的形象示人，一头金色飘逸的秀发迷倒众生，西装笔挺谈吐好不儒雅， 生意的版图也愈发宽广和稳固，大有一朝帝国吞吐山河的气势。但 人言可畏，众口难调。开源和独立开发圈子里总频频传出微软爸爸其实是个地中海秃头且是个暴发户的消息，名声并不显赫（是很不显赫- -）地位也偶遭鄙视（是时常遭嫌弃- -）。连我也有时候也怀疑（不是怀疑，简直就是快要相信），微软爸爸究竟是去植了发还是带着假发套，是不是金絮其外，败絮其中。  
但就在这时，突然有一天，我交到了一个身在企业级服务的好基友，此人却对微软爸爸无比崇拜，眼冒桃心。 这让我对微软爸爸的真实身份产生了强烈的好奇和兴趣。这时我拿出了在豆瓣天涯微博混迹时积累多年的追番/帖/热搜/扒皮的强大华丽堪比卓伟的狗仔技能树，对微软爸爸做了一番地毯式搜索。 然而结果令人惊艳！重磅消息重磅消息： 微软爸爸虽然那一头金发是染的！但人家不秃头，毛发健康且发色独具光泽，在企业级IT服务（特别时大体量级的企业级服务）方面有着卓越而突出的贡献和地位。  
被我误会多年秃头的微软爸爸，今天我要用大爱来感化你！用尊严来捍卫你！用我的实际行动支持你！我要带着你的两个儿子为你打call！今天的你在我眼里是zhui帅的！  
### 1. Azure生态圈和Power BI服务简介
确实从个人观点出发，在企业级服务和解决方案上，微软的表现比开源和独立开发上令人亮眼太多。而Power BI和Azure则分别在这个领域里各自扮演着他们极其重要的战略角色，承担起他们的服务职责。  
Azure开发生态圈作为企业级服务体系中的影响巨大，奠定基础的一环，为企业级开发方案提供了涵盖IaaS, Paas及SaaS不同层面的架构开发相关产品及服务；  
IaaS(Infrastructure as a Service)层包括了负载均衡（Load Balance），自动伸缩（auto-scaling），虚拟机（Virtual Machine）等基础设施服务；   
PaaS(Platform as a Service)拥有云服务（Cloud Service），移动服务（Mobile Service），网页应用部署（Website Deployment）等平台服务；  
SaaS（Service as a Service）则涵盖了如数据库（SQL， HDinsights...），IoT(Stream Analytics, IoT Hub, Event Hub)方面和数据分析可视化（Time Series Insights， Power BI）等不同领域的软件服务。
![](Azure Dashboard)
Power BI作为SaaS服务中的一项，是一套强大的商业智能分析及数据可视化工具， 能快速地将复杂的原始数据组织成直观有效的数据图表使得数据分析师或工程师能根据图表展示出的数据逻辑及趋势迅速进行决策，有效避免未来开发成本的增加，降低运作风险；  
使用Azure和Power BI能搭建一个完整的云端部署的可视化数据方案，让数据不在孤立于某个本地数据库或服务器中，在大数据时代下数据能够在云端有效共享，在终端设备多维展示，并能被实时分析，为推动公司方案决策，减少成本损失助力。
![](Power BI Cloud Solution Architecture)


### 2. 聊聊一个我们开篇就应该回答的问题：我们为什么需要实时数据可视化的方案？ 
在工业互联网时代到来的今天，大批的传统机械制造行业如石油，生产等都面临着严峻的生产设备和资产管理的数字转型（digital tranformation）。大部分工厂均为自己的设备配备了多维度的传感设备或遥感设备从而对自己的生产进程和设备健康进行监控和管理，而这些设备每天都将产生大量结构复杂且不易人类阅读的机器数据。这些机器数据将会被储存在不同的本地数据库中。大量的数据被孤立在本地不仅占用大量存储资源且无法为企业产生经济效益。为了解决这一痛点，首先这些数据需要被共享，以保证数据分析的正确性和利用最大化；其次数据应该能被实时流式处理，处理后的数据可以根据需要舍弃或保存；最后数据应该被统一的平台进行终端可视化，使得这些数据能快速被人类理解，分析以及基于数据进行预测。
信息化社会的迅猛发展早早就造就了一系列强大的传统数据分析和商业智能分析工具的诞生，这些软件大多采用ETL（Extract, Transform, Load）的传统方法从数据库加载数据到工具中再供用户进行操纵；由于受数据库读取和写入性能的限制，就算是在最完美的情况下，完成整个数据获取的过程也需要一分钟。 而工业级传感设备一般在每秒就能产生将近百万条的机器数据，数据频繁在数据库的更新要求分析工具连续地对数据库发出读请求，这样会造成数据库巨大的读写业务压力。因此大部分的传统数据分析工具（例如Tableau, Qlik）对实时数据可视化的支持非常不好，或者说甚至没有。 
从理论分析来看，对数据响应而进行有效决策（actionable time-critical decision）的最佳黄金时间往往发生在秒级别（近乎实时）。 因此，这推动了我们获取一种让分析工具能更快更好获得数据的处理方法。   
![]()
流式数据处理因而应运而生。这种处理方法能让数据处理表现几乎保持在实时。如果将数据比喻成水流，从数据源头流向数据终端，在这期间，我们在流经的某点建立起一座水进化处理工厂（即流式处理工具），对水流进行预先设置好的处理，在流经过程中完成整个处理过程，并提取聚合出我们对水流成分的感兴趣的一些信息，这样便能大大提高对数据处理的效率。而经过处理后的水流仍可以流向其终点，并使用传统的方法存入数据库供历史分析。  
![]()  
### 3. 用Power BI构建实时数据可视化仪表板 
注：此章节内容主要从博客[Build Real-Time Dashboard in Power BI](https://www.agilebi.com.au/blog/build-real-time-dashboard-power-bi)中翻译而来。  
#### Power BI接受的两种数据流入方法
Power BI作为商业智能分析工具的先驱和行业有利竞争者，似乎是敏锐地捕捉到这样的商机和市场需求，顺势推出了实时数据可视化的仪表盘，并且为了响应流式数据处理在IoT领域的强大需求，又推出了Azure Stream Analytics这一产品。使用Stream Analytics后能将数据无缝无延迟的推送到Power BI终端进行近乎实时的可视分析。而另一个使用该产品的好处是Stream Analytics能对数据进行预处理比如解析，聚合等，使得终端设备能够应对以各种形式组织的数据结构，大大增加了整个数据输入的横向可延展性（horizontal scalability）。  
另一种较之稍逊的方法是使用Power BI的Rest API直接将流数据推入Power BI中。这样做的缺点是，数据无法被预处理因此则要求产生数据的应用或数据库有能力将数据组织成Power BI能够识别的简单结构。否则Power BI将因无法识别数据而报错。  
#### 基于云部署的三种Power BI实时数据可视化架构方案
1. 

### 3. 玩转Power BI可视化
